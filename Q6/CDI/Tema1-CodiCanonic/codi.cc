#include <map>
#include <string>
#include <iostream>
#include <vector>
#include <algorithm>
using namespace std;

bool compara (const pair<char, int>& a, const pair <char, int>& b){
    if (a.second != b.second) return a.second < b.second;
    return a.first < b.first;
}

void codiCanonic(map<char, string>& CharToCod, map<string, char>& CodToChar, const vector<pair<char, int>>& codi) {
    string codificacio = "";
    int anterior = 0;
    
    //Fem el primer codi, sabem que son tots zeros
    codificacio = string(codi[0].second, '0');  //Tants 0s com longitud
    CharToCod[codi[0].first] = codificacio;
    CodToChar[codificacio] = codi[0].first;
    anterior = codi[0].second;
    
    for (int i = 1; i < codi.size(); ++i) {
        int num = 0;
        // Convertim la codificació anterior a decimal
        for (char c : codificacio) {
            num = (num << 1) + (c - '0');
        }
        num++;
        
        // Per comprovar que la longitud no es menor, es multiplica per 2 el binari, es a dir, un desplaçament
        while (anterior < codi[i].second) {
            num = num << 1;
            anterior++;
        }
        
        // Pasem el numero a binari
        codificacio = "";
        int aux = num;
        for (int j = 0; j < codi[i].second; ++j) {
            codificacio = char('0' + (aux & 1)) + codificacio;
            aux >>= 1;
        }
        
        // Guardem la codificació
        CharToCod[codi[i].first] = codificacio;
        CodToChar[codificacio] = codi[i].first;
        anterior = codi[i].second;
    }
}

//Funció per codificar el missatge
string encode (map<char, string>& CharToCod, const string& missatge){
    string s = "";
    for (char m : missatge){
        s += CharToCod[m];
    }
    return s;
}

//Funció per decodificar el missatge
string decode (map <string, char>& CodToChar, const string& missatge){
    string s ="";
    string CodAct = "";
    for (int i = 0; i < missatge.size(); ++i){
        CodAct += missatge[i];
        if (CodToChar.find(CodAct) != CodToChar.end()){
            s += CodToChar[CodAct];
            CodAct = "";
        }
    }
    return s;
}


int main () {
    vector<pair<char, int>> codi = {
        {' ', 3}, {'!', 8}, {'\'', 9}, {',', 5}, {'-', 9}, {'.', 6}, 
        {';', 10}, {'?', 8}, {'B', 10}, {'D', 10}, {'G', 8}, {'H', 7}, 
        {'I', 7}, {'M', 9}, {'P', 10}, {'T', 8}, {'W', 9}, {'Y', 11}, 
        {'[', 11}, {']', 10}, {'a', 4}, {'b', 7}, {'c', 6}, {'d', 4}, 
        {'e', 3}, {'f', 6}, {'g', 7}, {'h', 4}, {'i', 5}, {'k', 7}, {'l', 5}, 
        {'m', 5}, {'n', 4}, {'o', 4}, {'p', 6}, {'r', 5}, {'s', 5}, {'t', 4}, 
        {'u', 6}, {'v', 7}, {'w', 6}, {'x', 9}, {'y', 6}
    };
    //Ordenem la entrada
    sort(codi.begin(), codi.end(), compara);

    //Crea codificacio
    map <char, string> CharToCod;
    map <string, char> CodToChar;

    //Creem el codi canonic corresponent
    codiCanonic(CharToCod, CodToChar, codi);

    string missatge = "111110110110001000111011111001101100100011101010001000110110000111111110010001101011001100011000000111111010100011000001010011100010100000111100011101000011101101101000001111101011010000011111101100110110101101100100011111111111110100110100110100111111111000011111101010000111100111110011000101110011100011101000001001101111101110010100110000010101000101010111000100101100010000101100010001100011100101001110101010000001011100000111001110010010101101000000100011101010001110011010110010110000011010101110010001100000111110111000101101111011001110000001010101110000110101011100100001100100011101011101000001111101011000001010010010001111101010000101101000001111111101110000010111010110101110101111101011111000000011000100011001010010101010110100000011110001001000011110001001101011101011010101111111001000100101100100100100011101110001110010100110010000110111000110001001101000001001011001001001000111100011000111000100100111111100011001000101101000100011001001111110000001111101110001100000100010010110001000110110001100110010011100000010001110001001000100011011000010010110001000111001010010110101101111100000011101100100111101100100011101010001110000001100100100101110001001011000110111111110010001111101101100010111000110010110010011000110111101101110101010000011001001001101010111111100100011101110001111001110001010111011111011100101010001011111101000001001100010111101000001111110110110010010011111110001100100010010110001000101110100100110010011100011111001000111011100011100101001100100011001100101000111010110101011111110010001010101110001001011000100001011000100011000111001010011101010100000110010100101010101000111011111010000011101100010001101010100101110010001101101000110001110010100110000101000010001110101000100110001000111101000010111111010000010011000101111101000001111111011101101000100001010001000011100010010110001000110011011000100111110110011010000011001010010101010100001100011010000001000111010100011000100010110101100010101000111100001001101011111010000100101100010001101101011001000111011100110110110100000111011000100011011110001101011111010001100100101010000110101011100100011100100101001101111000011110100000110110001101101001000101111110100000100110001011100001001111000100011100010010001101110100101010111110110111000101101011011101010100000010001110101000101100010101000101110010001010101111100110101010100111010000011111111110100011100011000000010011000101110001010111001000111100011000100011110100010111101000000110001000110010100101010101101000000100011101010001001011000101111010000011111011001101101011000010111001000001111111100010011010110011011011101000001101000111001000101011001000011001001101111101110010111001010111111100111111100111100101100100100100001100100110111110111001011100101011111100100011101110001001100010110010100001101010110111000111001011001001001000111011100001100100010100011001001001011111111110100001001100010110010100001101010110111000101010111000111100011000100011110100010111000110010010111100100101111101010011100110100000111001101011001011000011110010100110011101111100100010001101100001101110100101010111000111100000110011110010010010111000100101100011011110100000010001110101000111101100111000111010000010100111111110010010011100010001110001100110110111010000010001110101000110011110011010111011010011011011101000001100010001111000100011100001110101000101111110100000100110001011100010111001010001111110010110101011011000111010000011101100010001100110110111000011111110010001010110010001101101100010001011100010111111010000110010110100011100010110010100111000101000001100110011000100001010001111000010011010111110100000100011101010001011010001000111101000101010000100100100010111001110100";

    //cout << encode(CharToCod, missatge);
    cout << decode(CodToChar, missatge);

}
